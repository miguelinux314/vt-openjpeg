function [a_lum,b_lum,b_c1,b_c2]=calc_VT_new_threshold(jnd_level)
if jnd_level~=1
    %error('only works for JND_level=1')
end
%function to show VTs for a given JND level on Monitor Asus PA-328Q, for
% VT5 or larger, extrapolations from VT1-VT4 are done.
% Feng Liu, 2/22/2016
% Input: jnd_level is the JND level, i.e., VT index
% Output: a_lum and b_lum are a and b coefficients to calculate VTs for a
% given JND level. VT=a*sig2+b
% Output: b_c1 and b_c2 are the VTs for Cb and Cr, respectively.
% All the output coefficients and VTs are 16 dimentional, arranged by [LL5,
% HL5, LH5, HH5, HL4, LH4, HH4, HL3, LH3, HH3, HL2, LH2, HH2, HL1, LH1,
% HH1].
%%
a_b1={{0.0393061899312421,0.00433708864327796},{0.00204177475486389,0.00154526673246704},{0.00112729395942739,0.000638451962517004},{0.000241220470218542,0.000378687683207916},{0.000477542584241842,0.000585241344726125}};
a_b2={{0.0485185068317250,0.00342580930062931},{0.00225442284633459,0.00140650574513955},{0.00137845344030698,0.000693302056409649},{0.000309763961169524,0.000430708357369612},{0.000612144233536813,0.000647934378866928}};
a_b3={{0.0300064681467924,0.00173503443620607},{0.00369915383946039,0.00182048435664677},{0.00155340778564751,0.000803519191659962},{0.000462373463966349,0.000457256489435820},{0.000703164795981749,0.000571237839572667}};
a_b4={{0.0290727395748646,0.000644830816917924},{0.00434404534192463,0.00156791755147101},{0.00172432694037594,0.000673875472882495},{0.000517927739011784,0.000513116364545300},{0.000716917538387347,0.000646972673003383}};
a_b5={{0.0109319976854877,0.00213356857489579},{0.00458360280415686,0.00169021146054170},{0.00191852727400392,0.000667592314954124},{0.000512495033555372,0.000652347130410112},{0.000848038123446818,0.000641814272197087}};
a_b6={{0.0165513532085011,0.00408175519391044},{0.00474296889450931,0.00179917876101125},{0.00217738517604171,0.000827352788946653},{0.000444108423474345,0.000717506198244873},{0.000931523109552699,0.000687858158138870}};
a_bs={{0.0258881117885302,0.00229145581666046},{0.00342281059031193,0.00163159268435200},{0.00160955665713271,0.000713901202847905},{0.000399620383538999,0.000511513899323421},{0.000698768845414265,0.000628897012845695}};
b_b1={{9.47287633995948,3.72283610670291},{1.77078039768350,0.871573939998642},{0.702137687918609,0.608465602455002},{0.505890470144748,0.447540530128035},{0.415293420481180,0.382691320230401}};
b_b2={{14.5774535018941,4.87646885047829},{2.24989296860497,1.15104803552979},{0.809491439975062,0.659755487103723},{0.581305539151728,0.511750034414467},{0.465304797535008,0.434084655468548}};
b_b3={{21.5414998901205,6.05940698449506},{2.58130969501846,1.29943208839722},{0.881402986606295,0.721475383961316},{0.636957952654720,0.551603027384164},{0.494147223178906,0.484341099986328}};
b_b4={{28.1249366542854,7.33552529213651},{2.93624716922495,1.55684815856524},{0.957923039632841,0.789845112882299},{0.687676072096987,0.587742313187429},{0.541146219833016,0.505435228069161}};
b_b5={{35.8329834468014,7.97417315137227},{3.29038844919062,1.73078788261667},{1.02958317266458,0.842091735638497},{0.734772989042317,0.628048534812246},{0.576232092347723,0.551771218714230}};
b_b6={{41.2716787379908,8.73991763078593},{3.67376612110808,1.92261227682623},{1.09598000665499,0.877321522613872},{0.799488246434283,0.664657289772031},{0.615837717834706,0.589124061157761}};
ab_bs={{6.55268681682981,1.01870396659253},{0.371181500945324,0.207195065587617},{0.0773144812793430,0.0559902307234187},{0.0565459814446203,0.0420176738633309},{0.0395000676531396,0.0401805006416194}};
bb_bs={{2.20250090293760,2.88592411958798},{1.45126221349646,0.696867667432305},{0.642152371097696,0.553859999910486},{0.459770943197960,0.418161763094737},{0.379743341749101,0.350609511692070}};
b1_c1={{128,128},{128,128},{17.9106643098601,2.94951873588676},{3.78068062969872,0.998011299607568},{0.607510535848851,0.607701590312628}};
b1_c2={{128,128},{128,2.09309373154831},{1.61979256634760,1.20292230006847},{1.16636527698937,0.946400521775300},{0.767490934370264,0.604517322739880}};
b2_c1={{128,128},{128,128},{128,3.76734662426825},{10.5182654000033,1.69686104200778},{0.919137710588956,0.736937695178067}};
b2_c2={{128,128},{128,2.96072780817329},{2.30200745554014,1.48372631921818},{1.51569057777514,1.12209855682695},{1.01986962415208,0.744440760700397}};
b3_c1={{128,128},{128,128},{128,5.12853035241829},{128,2.19690472634955},{1.27271477663976,0.856522433805792}};
b3_c2={{128,128},{128,4.67774385488046},{3.85286999390618,1.69349682433062},{1.83189078555938,1.25534262453520},{1.23195394950874,0.854771240647879}};
b4_c1={{128,128},{128,128},{128,8.52406722911980},{128,2.70532009328825},{1.75698728080976,1.03788185931584}};
b4_c2={{128,128},{128,7.03683390523834},{8.29421171419673,2.03877053533035},{2.00031419770869,1.47979520544745},{1.46352201491993,0.985140683118398}};
b5_c1={{128,128},{128,128},{128,17.4417514369166},{128,3.29433221046579},{2.29323109245853,1.21828925391952}};
b5_c2={{128,128},{128,9.78526908605870},{128,2.26943241494878},{2.22583969362199,1.71442276517571},{1.64034512342955,1.12105204952981}};
b6_c1={{128,128},{128,128},{128,128},{128,3.70486975907107},{2.65362522906756,1.38716698493363}};
b6_c2={{128,128},{128,128},{128,2.58761265159553},{2.57629089798738,1.91162667552829},{1.81224059922087,1.23757848172025}};
ab_c1={{0.0,0.0},{0.0,0.0},{0.0,0.0},{0.0,0.538146319132293},{0.423917889024922,0.157792602138269}};
ab_c2={{0.0,0.0},{0.0,0.0},{0.0,0.275024107309338},{0.267099967562283,0.195073027849242},{0.209049796785618,0.126443117253160}};
bb_c1={{256.0,256.0},{256.0,256.0},{256.0,256.0},{256.0,0.549204404835310},{0.100155159315009,0.421809195426971}};
bb_c2={{256.0,256.0},{256.0,256.0},{256.0,0.916742465332639},{0.951215351805667,0.722192127409135},{0.590896085517243,0.482032512690041}};

%% b for LL5
b_ll5=[0.685592700761521,0.742033237759156,0.762992801427690,0.793823216031755,0.819757330508854,0.856928961087898;
    0.706067754652443,0.784265893007400,1.07832910653056,1.43002627051325,1.61919342101566,1.84815774066071;
    0.669813632739133,0.805759555823776,1.00872822650578,1.08258440295412,1.23729656249215,1.39029248707526
    ];

%%
a_lum=0;
b_lum=b_ll5(1,jnd_level);
b_c1=b_ll5(2,jnd_level);
b_c2=b_ll5(3,jnd_level);
for res = 5:-1:1
    switch jnd_level
        case 1
            a_b=a_b1;
            b_b=b_b1;
            b_cb=b1_c1;
            b_cr=b1_c2;
        case 2
            a_b=a_b2;
            b_b=b_b2;
            b_cb=b2_c1;
            b_cr=b2_c2;
        case 3
            a_b=a_b3;
            b_b=b_b3;
            b_cb=b3_c1;
            b_cr=b3_c2;
        case 4
            a_b=a_b4;
            b_b=b_b4;
            b_cb=b4_c1;
            b_cr=b4_c2;
        case 5
            a_b=a_b5;
            b_b=b_b5;
            b_cb=b5_c1;
            b_cr=b5_c2;
        case 6
            a_b=a_b6;
            b_b=b_b6;
            b_cb=b6_c1;
            b_cr=b6_c2;
    end
    a_lum=[a_lum,a_b{res}{2},a_b{res}{2}]; %HL and LH
    a_lum=[a_lum,a_b{res}{1}]; %HH
    b_lum=[b_lum,b_b{res}{2},b_b{res}{2}]; %HL and LH
    b_lum=[b_lum,b_b{res}{1}]; %HH
    b_c1=[b_c1,b_cb{res}{2},b_cb{res}{2}]; %HL and LH
    b_c1=[b_c1,b_cb{res}{1}]; %HH
    b_c2=[b_c2,b_cr{res}{2},b_cr{res}{2}]; %HL and LH
    b_c2=[b_c2,b_cr{res}{1}]; %HH
    
end

